Rewriting parts of entropy package in C++
